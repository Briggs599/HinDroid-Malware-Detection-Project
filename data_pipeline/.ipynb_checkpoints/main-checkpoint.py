import os
import re
import numpy as np
import pandas as pd
import pickle
import json

#ToDO all:
# get pipeline working
# create more stable data extraction
# add comments
# move all magic number and params to data-params.json

mal_fp = "/teams/DSC180A_FA20_A00/a04malware/malware"
benign_fp = "/teams/DSC180A_FA20_A00/a04malware/popular-apps"


#import customs
from data_pipeline.model_file.model import *
from data_pipeline.structures import *
from data_pipeline.unpack import *
from data_pipeline.extract import *



#find relevent files
mal_list,benign_list = prep_files(mal_fp,benign_fp)

mal_file_names = [name for name in os.listdir(mal_fp) if os.path.isdir(name)] #Gets app names for labeling
benign_file_names = [name for name in os.listdir(benign_fp) if os.path.isdir(name)]



# individually create objects by file?
# Raya ~ extract.py
for i in mal_list:
    print()
    break
    # create features
    #save features
    
for i in benign_list:
    print()
    break
    # create features
    #save features

    
#Merge files
invoke_df = happy_invoke_df.join([benign_df,mal_df], how='outer').fillna(0)
df_feats = invoke_df.T

labels = np.zeros(benign_df.shape[0]).append(np.ones(mal_df.shape[0])
df_feats['label'] = labels
pd.to_csv("features_df",df_feats) #save progress
                                             
log_model(df_feats)
